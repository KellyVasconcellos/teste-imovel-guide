<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Imovel Guide</title>

    <link rel="stylesheet" href="./style.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&display=swap"
      rel="stylesheet"
    />

    <script>
      function mask(e, id, mask) {
        var tecla = window.event ? event.keyCode : e.which;
        if (tecla > 47 && tecla < 58) {
          mascara(id, mask);
          return true;
        } else {
          if (tecla == 8 || tecla == 0) {
            mascara(id, mask);
            return true;
          } else return false;
        }
      }
      function mascara(id, mask) {
        var i = id.value.length;
        var carac = mask.substring(i, i + 1);
        var prox_char = mask.substring(i + 1, i + 2);
        if (i == 0 && carac != "#") {
          insereCaracter(id, carac);
          if (prox_char != "#") insereCaracter(id, prox_char);
        } else if (carac != "#") {
          insereCaracter(id, carac);
          if (prox_char != "#") insereCaracter(id, prox_char);
        }
        function insereCaracter(id, char) {
          id.value += char;
        }
      }

      function calc() {
        var campo1 = document.querySelector(".campo1").value;
        var campo2 = document.querySelector(".campo2").value;
        var campo3 = document.querySelector(".campo3").value;
        var campo4 = document.querySelector(".campo4");

        var result = (parseInt(campo3) * parseInt(campo2)) / parseInt(campo1);

        document.querySelector(".campo4").value = parseInt(result);
      }

      function celular(element) {
        element.innerText = "(99)99999-9999";
      }

      function adcElemento() {
        var divNova = document.createElement("div");
        var conteudoNovo = document.createTextNode("Mensagem Enviada");
        divNova.classList.add("alert-enviar");
        divNova.appendChild(conteudoNovo);

        var divAtual = document.querySelector(".formulario-mensagem");
        divAtual.appendChild(divNova);

        setTimeout(() => {
          let div = document.querySelector(".alert-enviar");
          div.remove();
        }, 3000);
      }
    </script>
  </head>

  <body>
    <header>
      <img src="./img/logo.png" width="150" alt="ImovelGuide" />
      <div>
        <a href="">Condomínios</a>
        <a href="">Fórum</a>
        <a href="">Guia</a>
        <a href="">Artigos</a>
        <a href="">Ferramentas</a>
      </div>
      <div>
        <a href="">Cotar Imóvel</a>
        <a href="">Planos</a>
        <a href="">Entrar</a>
      </div>
      <button class="button-cadastrar">CADASTRE-SE</button>
    </header>

    <main>
      <div class="caixa corretores">
        <div class="equipe-corretores">
          <img src="./img/corretora.png" alt="" />
          <div class="espaco">
            <h3>Nome Corretora</h3>
            <p class="cor-azul">3.000 pontos</p>
            <a onclick="celular(this)">
              <p class="cor-laranja">ver telefone</p>
            </a>
          </div>
          <img src="./img/corretor.png" alt="" />
          <div class="espaco">
            <h3>Nome Corretor</h3>
            <p class="cor-azul">1.260 pontos</p>
            <a onclick="celular(this)">
              <p class="cor-laranja">ver telefone</p>
            </a>
          </div>
        </div>
      </div>

      <div class="caixa formulario-mensagem">
        <form>
          <h2>Mande uma mensagem:</h2>
          <input
            class="col-my-4"
            type="text"
            id="cpf"
            name="cpf"
            placeholder="Digite seu CPF"
            onkeypress="return mask(event, this, '###.###.###-##')"
            maxlength="14"
          />
          <input
            class="col-my-4"
            type="text"
            id="telefone"
            name="telefone"
            placeholder="Digite seu telefone"
            onkeypress="return mask(event, this, '(##) ####-####')"
            maxlength="15"
          />
          <textarea
            class="col-my-4"
            rows="5"
            id="mensagem"
            name="mensagem"
            placeholder="Digite o assunto"
          ></textarea>
        </form>
        <button class="botao mensagem" onclick="adcElemento()">
          Enviar Mensagem
        </button>
      </div>

      <div class="caixa regra-de-tres">
        <h2>Regra de 3</h2>
        <form>
          <div class="form1">
            <input
              class="col-my-4 col1 background-tag campo1"
              onkeyup="calc()"
              type="text"
              id="campo1"
              placeholder="60"
            />
            <div></div>
            <input
              class="col-my-4 campo2"
              onkeyup="calc()"
              type="text"
              id="campo2"
              placeholder="100"
            />
          </div>
          <div class="form2">
            <input
              class="col-my-4 campo3"
              onkeyup="calc()"
              type="text"
              id="campo3"
              placeholder="30"
            />
            <div></div>
            <input
              class="col-my-4 input-laranja campo4"
              onkeyup="calc()"
              type="text"
              id="result"
              placeholder=""
            />
          </div>
        </form>
        <button class="botao" id="calculate" onclick="calc()">Calcular</button>
      </div>

      <div class="caixa-botoes">
        <div class="caixa1 modal-my-img">
          <div class="background-img"></div>
        </div>
        <button class="botao modal-my" id="myBtn">ABRIR IMAGEM NO MODAL</button>
      </div>

      <div class="caixa-botoes caixa-botoes-download">
        <div class="caixa1 download-imagem">
          <div class="background-img">
            <button class="botao-background">Imovel Guide</button>
          </div>
        </div>
        <button class="botao download generate-image">Dowload</button>
      </div>

      <div class="caixa-botoes">
        <div class="caixa1 imagem">
          <div class="background-img"></div>
        </div>
      </div>

      <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
          <span class="close">&times;</span>
          <img src="./img/residencia.png" width="100%" />
        </div>
      </div>
      <a class="downloadImage"></a>
    </main>

    <footer>
      <div>
        <a>Termos</a>
        <a>Contatos</a>
        <a>Sobre</a>
      </div>
      <div>
        <span>© Copyright 2022. Todos os direitos reservados.</span>
      </div>
      <div>
        <img src="./img/logo.png" width="120" alt="ImovelGuide" width="100%" />
      </div>
    </footer>

    <script src="./js/html2canvas.min.js"></script>

    <script>
      // Get the modal
      var modal = document.getElementById("myModal");

      // Get the button that opens the modal
      var btn = document.getElementById("myBtn");

      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName("close")[0];

      // When the user clicks the button, open the modal
      btn.onclick = function () {
        modal.style.display = "block";
      };

      // When the user clicks on <span> (x), close the modal
      span.onclick = function () {
        modal.style.display = "none";
      };

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };

      let btnGenerate = document.querySelector(".generate-image");
      let btnDownload = document.querySelector('.downloadImage');

      btnGenerate.addEventListener("click", () => {
        html2canvas(document.querySelector(".caixa-botoes-download")).then((canvas) => {
          btnDownload.href = canvas.toDataURL('image/png');
          btnDownload.download = 'minha-div-em-imagem';
          btnDownload.click();
        });
      });
    </script>
  </body>
</html>
